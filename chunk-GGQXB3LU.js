import"./chunk-VEZLBGP7.js";import{b as Ne}from"./chunk-5IGTA6IO.js";import{a as A}from"./chunk-RVH4HJSJ.js";import{A as ne,F as ie,H as oe,Sa as xe,Ta as be,Ua as ye,Wa as Me,Xa as Se,Za as we,_ as ae,_a as Pe,aa as re,ab as ve,bb as Oe,db as ke,eb as Te,gb as Ie,ha as le,hb as Fe,ia as me,ib as De,jb as Ee,ka as ce,la as se,ma as q,oa as de,pa as pe,qa as ue,r as X,ra as ge,sa as fe,sb as B,ta as he,ua as _e,ub as j,w as Y,wa as Ce,x as Z,y as ee,z as te}from"./chunk-DMRUWG6L.js";import{Ab as O,Bb as y,Ca as G,Cb as M,Eb as S,Hb as _,Ic as $,Jb as u,Jc as W,Pc as K,Qc as P,Rb as C,Sb as m,Tb as Q,Ub as h,Vb as D,Wa as r,Wb as E,Xa as I,Xb as N,Zb as w,_b as H,bc as z,ec as R,f as x,fa as v,gc as L,ka as b,nb as d,pb as s,qb as J,qc as V,rb as F,ta as g,ua as f,yb as o,zb as a}from"./chunk-UIILES4X.js";import{e as T}from"./chunk-DVOCWXDE.js";function qe(t,l){if(t&1&&(o(0,"mat-option",14)(1,"span"),m(2),a()()),t&2){let e=l.$implicit;s("value",e._id),r(),J("color",e.color),r(),Q(e.name)}}var Re=(()=>{class t{constructor(e){this.ChangeDetectorRef=e,this.searchResults=new G,this.queries=new x,this.notification=v(B),this.checkData={date:"",lottery:"",lotteryNumber:""},this.loading=!1,this.lotteries=A}ngOnInit(){this.checkData.lottery=A[0]._id,this.ChangeDetectorRef.detectChanges()}onSubmit(e){if(!e.valid){this.notification.error("Por favor, complete todos los campos requeridos");return}if(e.valid){let i=[{date:e.value.date},{"lottery.id":e.value.lottery},{lotteryNumber:e.value.lotteryNumber}];this.queries.next(i)}}limpiarFormulario(e){e.resetForm(),this.checkData={date:"",lottery:"",lotteryNumber:""},this.queries.next([])}static{this.\u0275fac=function(i){return new(i||t)(I(V))}}static{this.\u0275cmp=b({type:t,selectors:[["app-check-hits-form"]],inputs:{queries:"queries"},outputs:{searchResults:"searchResults"},standalone:!0,features:[w],decls:27,vars:7,consts:[["checkForm","ngForm"],["lotterySelect",""],[1,"form-container"],[1,"form-card"],[1,"check-form",3,"ngSubmit"],["appearance","outline",1,"full-width"],["matInput","","type","date","name","date","required","",3,"ngModelChange","ngModel"],["appearance","outline"],["name","lottery","required","",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","text","name","lotteryNumber","required","","placeholder","Ingrese el n\xFAmero apostado",3,"ngModelChange","ngModel"],[1,"button-group"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-outlined-button","","type","button",3,"click","disabled"],[3,"value"]],template:function(i,n){if(i&1){let c=S();o(0,"div",2)(1,"mat-card",3)(2,"mat-card-header")(3,"mat-card-title"),m(4,"Consultar Aciertos"),a()(),o(5,"mat-card-content")(6,"form",4,0),_("ngSubmit",function(){g(c);let p=C(7);return f(n.onSubmit(p))}),o(8,"mat-form-field",5)(9,"mat-label"),m(10,"Fecha"),a(),o(11,"input",6),N("ngModelChange",function(p){return g(c),E(n.checkData.date,p)||(n.checkData.date=p),f(p)}),a()(),o(12,"mat-form-field",7)(13,"mat-label"),m(14,"Loter\xEDa"),a(),o(15,"mat-select",8,1),N("ngModelChange",function(p){return g(c),E(n.checkData.lottery,p)||(n.checkData.lottery=p),f(p)}),d(17,qe,3,4,"mat-option",9),a()(),o(18,"mat-form-field",5)(19,"mat-label"),m(20,"N\xFAmero apostado"),a(),o(21,"input",10),N("ngModelChange",function(p){return g(c),E(n.checkData.lotteryNumber,p)||(n.checkData.lotteryNumber=p),f(p)}),a()(),o(22,"div",11)(23,"button",12),m(24),a(),o(25,"button",13),_("click",function(){g(c);let p=C(7);return f(n.limpiarFormulario(p))}),m(26," Limpiar "),a()()()()()()}if(i&2){let c=C(7);r(11),D("ngModel",n.checkData.date),r(4),D("ngModel",n.checkData.lottery),r(2),s("ngForOf",n.lotteries),r(4),D("ngModel",n.checkData.lotteryNumber),r(2),s("disabled",!c.valid||n.loading),r(),h(" ",n.loading?"Consultando...":"Consultar"," "),r(),s("disabled",n.loading)}},dependencies:[Ce,ge,he,_e,fe,me,le,re,se,ce,Fe,Ie,ae,de,q,oe,ne,X,Y,Z,ie,te,ee,P,$,j],styles:[".form-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;padding:15px;height:fit-content}.form-card[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:16px;border-radius:8px;box-shadow:0 2px 8px #0000001a}.form-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{margin-bottom:12px;text-align:center}.form-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:18px;font-weight:500;color:#333;margin:0}.check-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.check-form[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%}.check-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]{border-radius:4px}.button-group[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:center;margin-top:12px}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:90px;height:36px;border-radius:4px;font-weight:500;font-size:14px}.button-group[_ngcontent-%COMP%]   button[color=primary][_ngcontent-%COMP%]:disabled{background:#ccc;color:#999}@media (max-width: 768px){.form-container[_ngcontent-%COMP%]{padding:12px}.form-card[_ngcontent-%COMP%]{max-width:100%;padding:12px}.button-group[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}@media (min-width: 1025px){.form-container[_ngcontent-%COMP%]{padding:0;height:auto}.form-card[_ngcontent-%COMP%]{max-width:350px}}"]})}}return t})();var U=()=>[void 0,null,""];function Be(t,l){t&1&&(o(0,"div",8)(1,"p"),m(2,"Consultando aciertos..."),a()())}function je(t,l){t&1&&(o(0,"th",20),m(1," N\xFAmero "),a())}function Le(t,l){if(t&1&&(o(0,"td",21),m(1),a()),t&2){let e=l.$implicit;r(),h(" ",e.lotteryNumber," ")}}function Ae(t,l){t&1&&(o(0,"th",20),m(1," Vendedor "),a())}function Ue(t,l){if(t&1&&(o(0,"td",21),m(1),a()),t&2){let e=l.$implicit;r(),h(" ",e.seller.name," ")}}function Ge(t,l){t&1&&(o(0,"th",20),m(1," Combinado "),a())}function Je(t,l){t&1&&(o(0,"span",23)(1,"mat-icon"),m(2,"sync"),a()())}function Qe(t,l){t&1&&(o(0,"span",24)(1,"mat-icon"),m(2,"sync_disabled"),a()())}function $e(t,l){if(t&1&&(o(0,"td",21),d(1,Je,3,0,"span",22)(2,Qe,3,0,"ng-template",null,0,L),a()),t&2){let e=l.$implicit,i=C(3);r(),s("ngIf",e.combined)("ngIfElse",i)}}function Ke(t,l){t&1&&(o(0,"th",20),m(1," Valor "),a())}function Xe(t,l){if(t&1&&(o(0,"td",21),m(1),z(2,"currency"),a()),t&2){let e=l.$implicit;r(),h(" ",R(2,1,e.value,"COP","symbol")," ")}}function Ye(t,l){t&1&&(o(0,"th",20),m(1," Premio "),a())}function Ze(t,l){if(t&1&&(o(0,"span",26)(1,"mat-icon"),m(2,"notification_important"),a(),m(3),z(4,"currency"),a()),t&2){let e=u().$implicit,i=u(2);r(3),h(" ",R(4,1,i.calculatePrize(e).value,"COP","symbol")," ")}}function et(t,l){t&1&&(o(0,"span",27),m(1,"Sin premio"),a())}function tt(t,l){if(t&1&&(o(0,"td",21),d(1,Ze,5,5,"span",25)(2,et,2,0,"ng-template",null,1,L),a()),t&2){let e=l.$implicit,i=C(3),n=u(2);F("premio-winner",H(4,U).includes(n.lotteryNumber)?!1:n.calculatePrize(e).isWinner),r(),s("ngIf",H(5,U).includes(n.lotteryNumber)?!1:n.calculatePrize(e).isWinner)("ngIfElse",i)}}function nt(t,l){t&1&&O(0,"tr",28)}function it(t,l){t&1&&O(0,"tr",29)}function ot(t,l){if(t&1&&(o(0,"table",9),y(1,10),d(2,je,2,0,"th",11)(3,Le,2,1,"td",12),M(),y(4,13),d(5,Ae,2,0,"th",11)(6,Ue,2,1,"td",12),M(),y(7,14),d(8,Ge,2,0,"th",11)(9,$e,4,2,"td",12),M(),y(10,15),d(11,Ke,2,0,"th",11)(12,Xe,3,5,"td",12),M(),y(13,16),d(14,Ye,2,0,"th",11)(15,tt,4,6,"td",17),M(),d(16,nt,1,0,"tr",18)(17,it,1,0,"tr",19),a()),t&2){let e=u();s("dataSource",e.dataSource),r(16),s("matHeaderRowDef",e.displayedColumns),r(),s("matRowDefColumns",e.displayedColumns)}}function at(t,l){if(t&1&&(o(0,"div",30),m(1),z(2,"currency"),a()),t&2){let e=u();r(),h(" ","Total Premios: "+R(2,1,e.totalPaymentWinner,"COP","symbol")," ")}}function rt(t,l){if(t&1){let e=S();o(0,"mat-paginator",31),_("page",function(n){g(e);let c=u();return f(c.onPageChange(n))}),a()}if(t&2){let e=u();s("length",e.totalItems)("pageSize",e.pageSize)("pageIndex",e.pageIndex>0?e.pageIndex-1:0)("pageSizeOptions",e.arraySize)}}var Ve=(()=>{class t{constructor(e){this.cdr=e,this.queries=new x,this.loading=!1,this.registerBetsUseCase=v(Ne),this.notification=v(B),this.dataSource=[],this.paymentDataSource=[],this.displayedColumns=["numero","vendedor","combinado","valor","premio"],this.pageIndex=1,this.pageSize=10,this.totalItems=0,this.lotteryNumber="",this.arraySize=[10,20,50,100],this.totalPaymentWinner=0}ngOnInit(){return T(this,null,function*(){yield this.getDataSource(),this.getPaymentParameterization(),this.queries.subscribe(e=>T(this,null,function*(){this.lotteryNumber=e.find(i=>i.lotteryNumber)?.lotteryNumber||"",yield this.getDataSource(e),this.calculatePaymentWinner()}))})}ngOnDestroy(){}getDataSource(e){return T(this,null,function*(){this.loading=!0;try{this.totalItems=yield this.registerBetsUseCase.getTotalBetsByQueries(e),e&&e.length>0?(this.pageSize=this.totalItems,this.arraySize=[this.totalItems]):(this.pageSize=10,this.arraySize=[10,20,50,100]),this.dataSource=yield this.registerBetsUseCase.getBetsByPagination(this.pageIndex,this.pageSize,e)}catch(i){this.notification.error("Error al cargar los vendedores: "+i.message)}finally{this.loading=!1}this.cdr.detectChanges()})}getPaymentParameterization(){localStorage.getItem("paymentDataSource");let e=localStorage.getItem("paymentDataSource");e?this.paymentDataSource=JSON.parse(e):this.paymentDataSource=[]}onPageChange(e){this.pageIndex=e.pageIndex===0?1:e.pageIndex+1,this.pageSize=e.pageSize,this.getDataSource()}calculatePrize(e){let i,n=!1;if(this.lotteryNumber!==e.lotteryNumber&&this.lotteryNumber.length!==e.lotteryNumber?.length){if(i=this.paymentDataSource.find(c=>c.digits===e.lotteryNumber?.length),!i)return{isWinner:!1,value:0};n=!0}else if(this.lotteryNumber!==e.lotteryNumber&&this.lotteryNumber.length===e.lotteryNumber?.length&&e.combined===!0){if(i=this.paymentDataSource.find(c=>c.digits===e.lotteryNumber?.length&&c.combined===!0),!i)return{isWinner:!1,value:0};n=!0}else if(this.lotteryNumber===e.lotteryNumber&&e.combined===!0){if(i=this.paymentDataSource.find(c=>c.digits===e.lotteryNumber?.length&&c.combined===!0),!i)return{isWinner:!1,value:0};n=!0}else if(this.lotteryNumber===e.lotteryNumber&&e.combined===!1){if(i=this.paymentDataSource.find(c=>c.digits===e.lotteryNumber?.length&&c.combined===!1),!i)return{isWinner:!1,value:0};n=!0}return{isWinner:n,value:i?.amount*e.value||0}}calculatePaymentWinner(){this.totalPaymentWinner=this.dataSource.reduce((e,i)=>{let n=this.calculatePrize(i);return e+(n.isWinner?n.value:0)},0)}static{this.\u0275fac=function(i){return new(i||t)(I(V))}}static{this.\u0275cmp=b({type:t,selectors:[["app-check-hits-table"]],inputs:{queries:"queries",loading:"loading"},standalone:!0,features:[w],decls:6,vars:5,consts:[["noCombinado",""],["noPremio",""],[2,"background-color","white","border-radius","8px","padding","20px","box-shadow","0 2px 10px rgba(0,0,0,0.1)"],["class","loading-container",4,"ngIf"],[1,"table-responsive"],["mat-table","",3,"dataSource",4,"ngIf"],["class","totalValue","style","text-align: right; color: red; padding-right: 10px; font-weight: 600; background-color: #FFFFFF;",4,"ngIf"],["showFirstLastButtons","","aria-label","Seleccionar p\xE1gina de vendedores",3,"length","pageSize","pageIndex","pageSizeOptions","page",4,"ngIf"],[1,"loading-container"],["mat-table","",3,"dataSource"],["matColumnDef","numero"],["mat-header-cell","","style","text-align: right;",4,"matHeaderCellDef"],["mat-cell","","style","text-align: right;",4,"matCellDef"],["matColumnDef","vendedor"],["matColumnDef","combinado"],["matColumnDef","valor"],["matColumnDef","premio"],["mat-cell","","style","text-align: right;",3,"premio-winner",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",2,"text-align","right"],["mat-cell","",2,"text-align","right"],["matTooltip","Combinado","style","display: flex; align-items: center; gap: 4px; justify-content: flex-end;","class","combinado",4,"ngIf","ngIfElse"],["matTooltip","Combinado",1,"combinado",2,"display","flex","align-items","center","gap","4px","justify-content","flex-end"],["matTooltip","No Combinado",1,"no-combinado",2,"display","flex","align-items","center","gap","4px","justify-content","flex-end"],["style","display: flex; align-items: center; gap: 4px; justify-content: flex-end;",4,"ngIf","ngIfElse"],[2,"display","flex","align-items","center","gap","4px","justify-content","flex-end"],[1,"no-prize",2,"display","flex","align-items","center","gap","4px","justify-content","flex-end"],["mat-header-row",""],["mat-row",""],[1,"totalValue",2,"text-align","right","color","red","padding-right","10px","font-weight","600","background-color","#FFFFFF"],["showFirstLastButtons","","aria-label","Seleccionar p\xE1gina de vendedores",3,"page","length","pageSize","pageIndex","pageSizeOptions"]],template:function(i,n){i&1&&(o(0,"div",2),d(1,Be,3,0,"div",3),o(2,"div",4),d(3,ot,18,3,"table",5)(4,at,3,5,"div",6),a(),d(5,rt,1,4,"mat-paginator",7),a()),i&2&&(r(),s("ngIf",n.loading),r(2),s("ngIf",!n.loading),r(),s("ngIf",!H(4,U).includes(n.lotteryNumber)&&!n.loading),r(),s("ngIf",!n.loading))},dependencies:[Te,xe,ye,Pe,Me,be,ve,Se,we,Oe,ke,Ee,De,P,W,K,ue,pe],styles:['@charset "UTF-8";.table-container[_ngcontent-%COMP%]{padding:20px;height:100%;display:flex;flex-direction:column;max-width:800px;margin:0 auto}.mat-elevation-z8[_ngcontent-%COMP%]{border-radius:8px 8px 0 0!important;box-shadow:0 2px 8px #0000001a}table[_ngcontent-%COMP%]{width:100%;overflow:hidden;flex:1}.table-row[_ngcontent-%COMP%]{height:20px!important}.mat-mdc-header-row[_ngcontent-%COMP%]{height:40px!important}.mat-mdc-cell[_ngcontent-%COMP%], .mat-mdc-header-cell[_ngcontent-%COMP%]{padding:4px 12px!important;font-size:14px;line-height:1.2}.loading-container[_ngcontent-%COMP%]{padding:40px;text-align:center;color:#666;font-style:italic}.premio-winner[_ngcontent-%COMP%]{font-weight:600;color:#4caf50}.combinado[_ngcontent-%COMP%]{font-weight:600;color:#03fc0c}.no-combinado[_ngcontent-%COMP%]{font-weight:600;color:#f70505}.no-prize[_ngcontent-%COMP%]{color:#999;font-style:italic}.totalValue[_ngcontent-%COMP%]{font-weight:600;background-color:#fff}@media (max-width: 768px){.table-container[_ngcontent-%COMP%]{padding:16px}table[_ngcontent-%COMP%]{font-size:14px}.mat-mdc-cell[_ngcontent-%COMP%], .mat-mdc-header-cell[_ngcontent-%COMP%]{padding:3px 6px!important}.table-row[_ngcontent-%COMP%]{height:28px!important}}@media (min-width: 1025px){.table-container[_ngcontent-%COMP%]{padding:0;height:calc(100vh - 40px);max-width:100%;margin:0}}']})}}return t})();function lt(t,l){if(t&1){let e=S();o(0,"div",7)(1,"div",7)(2,"app-check-hits-form",8),_("searchResults",function(n){g(e);let c=u();return f(c.onSearchResults(n))}),a()()()}if(t&2){let e=u();r(2),s("queries",e.queries)}}var Kt=(()=>{class t{constructor(){this.queries=new x,this.searchResults=[],this.loading=!1,this.showForm=!1,this.isMobile=!1}ngOnInit(){}ngOnDestroy(){this.queries.complete()}onSearchResults(e){this.searchResults=e}toggleForm(){this.showForm=!this.showForm}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=b({type:t,selectors:[["app-check-hits"]],standalone:!0,features:[w],decls:8,vars:6,consts:[[1,"alert-layout"],[1,"toolbar"],["mat-raised-button","","color","primary",3,"click"],[1,"layout"],["class","form-section",4,"ngIf"],[1,"table-section"],[3,"loading","queries"],[1,"form-section"],[3,"searchResults","queries"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"div",1)(2,"button",2),_("click",function(){return n.toggleForm()}),m(3),a()(),o(4,"div",3),d(5,lt,3,1,"div",4),o(6,"div",5),O(7,"app-check-hits-table",6),a()()()),i&2&&(r(3),h(" ",n.showForm?"Ocultar formulario":"Consultar aciertos"," "),r(),F("column",n.isMobile),r(),s("ngIf",n.showForm),r(2),s("loading",n.loading)("queries",n.queries))},dependencies:[Re,Ve,P,W,j,q],styles:[".layout[_ngcontent-%COMP%]{display:flex;gap:24px;padding:20px;box-sizing:border-box}.layout.column[_ngcontent-%COMP%]{flex-direction:column}.layout.column[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%], .layout.column[_ngcontent-%COMP%]   .table-section[_ngcontent-%COMP%]{width:100%;flex:none}.form-section[_ngcontent-%COMP%]{flex:0 0 350px;min-width:0}.table-section[_ngcontent-%COMP%]{flex:1;min-width:0}.toolbar[_ngcontent-%COMP%]{padding:16px 20px 0}@media screen and (max-width: 1300px){.layout[_ngcontent-%COMP%]{flex-direction:column}.form-section[_ngcontent-%COMP%]{flex:none;width:100%}.table-section[_ngcontent-%COMP%]{width:100%}}"]})}}return t})();export{Kt as CheckHitsPage};
