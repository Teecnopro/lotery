import{A as x,B as b,C as q,D as u,n as D,q as p,r as A,s as h,t as I,u as w,v as d,x as m,y as j,z as f}from"./chunk-VJ6QB3KB.js";import{$ as v,ea as B}from"./chunk-M2SJCD5Z.js";import{a as n,c as R,e as a}from"./chunk-DVOCWXDE.js";var k=(()=>{class S{constructor(t){this.firestore=t}getAll(){return a(this,null,function*(){let t=p(this.firestore,"sellers");return(yield d(t)).docs.map(s=>n({id:s.id},s.data()))})}getById(t){return a(this,null,function*(){let e=h(this.firestore,"sellers",t),s=yield w(e);return s.exists()?n({id:s.id},s.data()):null})}findAll(){return a(this,null,function*(){let t=p(this.firestore,"sellers");return(yield d(t)).docs.map(s=>n({id:s.id},s.data()))})}findById(t){return a(this,null,function*(){let e=h(this.firestore,"sellers",t),s=yield w(e);return s.exists()?n({id:s.id},s.data()):null})}create(t){return a(this,null,function*(){let e=h(this.firestore,"sellers",t.uid);return yield x(e,t),t})}update(t,e){return a(this,null,function*(){let s=h(this.firestore,"sellers",t),r=R(e,[]);return yield q(s,r),e})}delete(t){return a(this,null,function*(){let e=h(this.firestore,"sellers",t);yield A(e)})}findBy(t,e){return a(this,null,function*(){let s=p(this.firestore,"sellers"),r=f(s,u(t,"==",e));return(yield d(r)).docs.map(o=>n({id:o.id},o.data()))})}getSellerByCode(t){return a(this,null,function*(){let e=p(this.firestore,"sellers"),s=f(e,u("code","==",t)),r=yield d(s);return r.empty?null:n({id:r.docs[0].id},r.docs[0].data())})}getSellersByCodeOrName(t){return a(this,null,function*(){let e=p(this.firestore,"sellers"),s=f(e,u("code",">=",t),u("code","<",t+"\uF8FF")),r=f(e,u("name",">=",t),u("name","<",t+"\uF8FF")),[i,o]=yield Promise.all([d(s),d(r)]),c=new Map;return i.docs.forEach(l=>c.set(l.id,n({id:l.id},l.data()))),o.docs.forEach(l=>c.set(l.id,n({id:l.id},l.data()))),Array.from(c.values())})}updateState(t,e,s){return a(this,null,function*(){let r=h(this.firestore,"sellers",t);yield q(r,{state:e,updatedAt:new Date().valueOf(),updatedBy:s});let i=yield w(r);if(!i.exists())throw new Error("Seller not found");return n({id:i.id},i.data())})}getSellerByPagination(t,e,s){return a(this,null,function*(){let r=p(this.firestore,"sellers"),i=t-1,o=[];if(s)for(let[c,l]of Object.entries(s))o.push(u(c,"==",l));if(o.push(j("createdAt","desc")),i===0){let c=f(r,...o,m(e));return(yield d(c)).docs.map(y=>n({uid:y.id},y.data()))}else{let c=f(r,...o,m(i*e)),y=(yield d(c)).docs;if(y.length<i*e)return[];let C=y[y.length-1],E=f(r,...o,b(C),m(e));return(yield d(E)).docs.map(g=>n({uid:g.id},g.data()))}})}getTotalItems(t){return a(this,null,function*(){let e=p(this.firestore,"sellers"),s=[];if(t)for(let[o,c]of Object.entries(t))s.push(u(o,"==",c));let r=f(e,...s);return(yield I(r)).data().count})}getSellersActive(){return a(this,null,function*(){let t=p(this.firestore,"sellers"),e=f(t,u("state","==",!0));return(yield d(e)).docs.map(r=>n({id:r.id},r.data()))})}static{this.\u0275fac=function(e){return new(e||S)(B(D))}}static{this.\u0275prov=v({token:S,factory:S.\u0275fac,providedIn:"root"})}}return S})();export{k as a};
